/* GMenuEntries.c generated by valac 0.30.1, the Vala compiler
 * generated from GMenuEntries.vala, do not modify */


#include <glib.h>
#include <glib-object.h>
#include <stdlib.h>
#include <string.h>
#include <gee.h>
#include <gnome-menus/gmenu-tree.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <gtk/gtk.h>
#include <gio/gio.h>
#include <stdio.h>


#define SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES (slingshot_backend_gmenu_entries_get_type ())
#define SLINGSHOT_BACKEND_GMENU_ENTRIES(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES, SlingshotBackendGMenuEntries))
#define SLINGSHOT_BACKEND_GMENU_ENTRIES_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES, SlingshotBackendGMenuEntriesClass))
#define SLINGSHOT_BACKEND_IS_GMENU_ENTRIES(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES))
#define SLINGSHOT_BACKEND_IS_GMENU_ENTRIES_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES))
#define SLINGSHOT_BACKEND_GMENU_ENTRIES_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES, SlingshotBackendGMenuEntriesClass))

typedef struct _SlingshotBackendGMenuEntries SlingshotBackendGMenuEntries;
typedef struct _SlingshotBackendGMenuEntriesClass SlingshotBackendGMenuEntriesClass;
typedef struct _SlingshotBackendGMenuEntriesPrivate SlingshotBackendGMenuEntriesPrivate;
#define _g_free0(var) (var = (g_free (var), NULL))
#define _gmenu_tree_item_unref0(var) ((var == NULL) ? NULL : (var = (gmenu_tree_item_unref (var), NULL)))
#define _gmenu_tree_unref0(var) ((var == NULL) ? NULL : (var = (gmenu_tree_unref (var), NULL)))
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _gtk_icon_info_free0(var) ((var == NULL) ? NULL : (var = (gtk_icon_info_free (var), NULL)))

struct _SlingshotBackendGMenuEntries {
	GObject parent_instance;
	SlingshotBackendGMenuEntriesPrivate * priv;
};

struct _SlingshotBackendGMenuEntriesClass {
	GObjectClass parent_class;
};


static gpointer slingshot_backend_gmenu_entries_parent_class = NULL;

GType slingshot_backend_gmenu_entries_get_type (void) G_GNUC_CONST;
enum  {
	SLINGSHOT_BACKEND_GMENU_ENTRIES_DUMMY_PROPERTY
};
static void slingshot_backend_gmenu_entries_log (const gchar* msg);
GeeArrayList* slingshot_backend_gmenu_entries_get_categories (void);
GeeArrayList* slingshot_backend_gmenu_entries_get_applications_for_category (GMenuTreeDirectory* category);
GeeArrayList* slingshot_backend_gmenu_entries_get_all (void);
void slingshot_backend_gmenu_entries_enumerate_apps (GeeArrayList* source, GeeHashMap* icons, gint icon_size, GeeArrayList** list);
SlingshotBackendGMenuEntries* slingshot_backend_gmenu_entries_new (void);
SlingshotBackendGMenuEntries* slingshot_backend_gmenu_entries_construct (GType object_type);


static void slingshot_backend_gmenu_entries_log (const gchar* msg) {
	g_return_if_fail (msg != NULL);
}


static gpointer _gmenu_tree_ref0 (gpointer self) {
	return self ? gmenu_tree_ref (self) : NULL;
}


static gpointer _gmenu_tree_item_ref0 (gpointer self) {
	return self ? gmenu_tree_item_ref (self) : NULL;
}


GeeArrayList* slingshot_backend_gmenu_entries_get_categories (void) {
	GeeArrayList* result = NULL;
	GMenuTree* tree = NULL;
	GMenuTree* _tmp0_ = NULL;
	GMenuTree* _tmp1_ = NULL;
	GMenuTreeDirectory* root = NULL;
	GMenuTree* _tmp2_ = NULL;
	GMenuTreeDirectory* _tmp3_ = NULL;
	GMenuTreeDirectory* _tmp4_ = NULL;
	GMenuTreeDirectory* _tmp5_ = NULL;
	const gchar* _tmp6_ = NULL;
	gchar* _tmp7_ = NULL;
	gchar* _tmp8_ = NULL;
	GeeArrayList* main_directory_entries = NULL;
	GeeArrayList* _tmp9_ = NULL;
	GMenuTreeDirectory* _tmp10_ = NULL;
	GSList* _tmp11_ = NULL;
	_tmp0_ = gmenu_tree_lookup ("applications.menu", GMENU_TREE_FLAGS_INCLUDE_EXCLUDED);
	_tmp1_ = _gmenu_tree_ref0 (_tmp0_);
	tree = _tmp1_;
	_tmp2_ = tree;
	_tmp3_ = gmenu_tree_get_root_directory (_tmp2_);
	_tmp4_ = _gmenu_tree_item_ref0 (_tmp3_);
	root = _tmp4_;
	_tmp5_ = root;
	_tmp6_ = gmenu_tree_directory_get_name (_tmp5_);
	_tmp7_ = g_strconcat ("Menu root: ", _tmp6_, NULL);
	_tmp8_ = _tmp7_;
	slingshot_backend_gmenu_entries_log (_tmp8_);
	_g_free0 (_tmp8_);
	_tmp9_ = gee_array_list_new (G_TYPE_POINTER, (GBoxedCopyFunc) gmenu_tree_item_ref, gmenu_tree_item_unref, NULL);
	main_directory_entries = _tmp9_;
	_tmp10_ = root;
	_tmp11_ = gmenu_tree_directory_get_contents (_tmp10_);
	{
		GSList* item_collection = NULL;
		GSList* item_it = NULL;
		item_collection = _tmp11_;
		for (item_it = item_collection; item_it != NULL; item_it = item_it->next) {
			GMenuTreeItem* _tmp12_ = NULL;
			GMenuTreeItem* item = NULL;
			_tmp12_ = _gmenu_tree_item_ref0 ((GMenuTreeItem*) item_it->data);
			item = _tmp12_;
			{
				GMenuTreeItem* _tmp13_ = NULL;
				GMenuTreeItemType _tmp14_ = 0;
				_tmp13_ = item;
				_tmp14_ = gmenu_tree_item_get_type (_tmp13_);
				if (_tmp14_ == GMENU_TREE_ITEM_DIRECTORY) {
					GeeArrayList* _tmp15_ = NULL;
					GMenuTreeItem* _tmp16_ = NULL;
					_tmp15_ = main_directory_entries;
					_tmp16_ = item;
					gee_abstract_collection_add ((GeeAbstractCollection*) _tmp15_, (GMenuTreeDirectory*) _tmp16_);
				}
				_gmenu_tree_item_unref0 (item);
			}
		}
	}
	result = main_directory_entries;
	_gmenu_tree_item_unref0 (root);
	_gmenu_tree_unref0 (tree);
	return result;
}


GeeArrayList* slingshot_backend_gmenu_entries_get_applications_for_category (GMenuTreeDirectory* category) {
	GeeArrayList* result = NULL;
	GeeArrayList* entries = NULL;
	GeeArrayList* _tmp0_ = NULL;
	GMenuTreeDirectory* _tmp1_ = NULL;
	GSList* _tmp2_ = NULL;
	g_return_val_if_fail (category != NULL, NULL);
	_tmp0_ = gee_array_list_new (G_TYPE_POINTER, (GBoxedCopyFunc) gmenu_tree_item_ref, gmenu_tree_item_unref, NULL);
	entries = _tmp0_;
	_tmp1_ = category;
	_tmp2_ = gmenu_tree_directory_get_contents (_tmp1_);
	{
		GSList* item_collection = NULL;
		GSList* item_it = NULL;
		item_collection = _tmp2_;
		for (item_it = item_collection; item_it != NULL; item_it = item_it->next) {
			GMenuTreeItem* _tmp3_ = NULL;
			GMenuTreeItem* item = NULL;
			_tmp3_ = _gmenu_tree_item_ref0 ((GMenuTreeItem*) item_it->data);
			item = _tmp3_;
			{
				GMenuTreeItem* _tmp4_ = NULL;
				GMenuTreeItemType _tmp5_ = 0;
				_tmp4_ = item;
				_tmp5_ = gmenu_tree_item_get_type (_tmp4_);
				switch (_tmp5_) {
					case GMENU_TREE_ITEM_DIRECTORY:
					{
						GeeArrayList* _tmp6_ = NULL;
						GMenuTreeItem* _tmp7_ = NULL;
						GeeArrayList* _tmp8_ = NULL;
						GeeArrayList* _tmp9_ = NULL;
						GMenuTreeItem* _tmp10_ = NULL;
						const gchar* _tmp11_ = NULL;
						gchar* _tmp12_ = NULL;
						gchar* _tmp13_ = NULL;
						_tmp6_ = entries;
						_tmp7_ = item;
						_tmp8_ = slingshot_backend_gmenu_entries_get_applications_for_category ((GMenuTreeDirectory*) _tmp7_);
						_tmp9_ = _tmp8_;
						gee_abstract_collection_add_all ((GeeAbstractCollection*) _tmp6_, (GeeCollection*) _tmp9_);
						_g_object_unref0 (_tmp9_);
						_tmp10_ = item;
						_tmp11_ = gmenu_tree_directory_get_name ((GMenuTreeDirectory*) _tmp10_);
						_tmp12_ = g_strconcat ("Directory: ", _tmp11_, NULL);
						_tmp13_ = _tmp12_;
						slingshot_backend_gmenu_entries_log (_tmp13_);
						_g_free0 (_tmp13_);
						break;
					}
					case GMENU_TREE_ITEM_ENTRY:
					{
						GeeArrayList* _tmp14_ = NULL;
						GMenuTreeItem* _tmp15_ = NULL;
						GMenuTreeItem* _tmp16_ = NULL;
						const gchar* _tmp17_ = NULL;
						gchar* _tmp18_ = NULL;
						gchar* _tmp19_ = NULL;
						_tmp14_ = entries;
						_tmp15_ = item;
						gee_abstract_collection_add ((GeeAbstractCollection*) _tmp14_, (GMenuTreeEntry*) _tmp15_);
						_tmp16_ = item;
						_tmp17_ = gmenu_tree_entry_get_desktop_file_path ((GMenuTreeEntry*) _tmp16_);
						_tmp18_ = g_strconcat ("Application: ", _tmp17_, NULL);
						_tmp19_ = _tmp18_;
						slingshot_backend_gmenu_entries_log (_tmp19_);
						_g_free0 (_tmp19_);
						break;
					}
					default:
					break;
				}
				_gmenu_tree_item_unref0 (item);
			}
		}
	}
	result = entries;
	return result;
}


static gpointer _g_object_ref0 (gpointer self) {
	return self ? g_object_ref (self) : NULL;
}


GeeArrayList* slingshot_backend_gmenu_entries_get_all (void) {
	GeeArrayList* result = NULL;
	GeeArrayList* the_apps = NULL;
	GeeArrayList* _tmp0_ = NULL;
	GeeArrayList* all_categories = NULL;
	GeeArrayList* _tmp1_ = NULL;
	_tmp0_ = gee_array_list_new (G_TYPE_POINTER, (GBoxedCopyFunc) gmenu_tree_item_ref, gmenu_tree_item_unref, NULL);
	the_apps = _tmp0_;
	_tmp1_ = slingshot_backend_gmenu_entries_get_categories ();
	all_categories = _tmp1_;
	{
		GeeArrayList* _directory_list = NULL;
		GeeArrayList* _tmp2_ = NULL;
		GeeArrayList* _tmp3_ = NULL;
		gint _directory_size = 0;
		GeeArrayList* _tmp4_ = NULL;
		gint _tmp5_ = 0;
		gint _tmp6_ = 0;
		gint _directory_index = 0;
		_tmp2_ = all_categories;
		_tmp3_ = _g_object_ref0 (_tmp2_);
		_directory_list = _tmp3_;
		_tmp4_ = _directory_list;
		_tmp5_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp4_);
		_tmp6_ = _tmp5_;
		_directory_size = _tmp6_;
		_directory_index = -1;
		while (TRUE) {
			gint _tmp7_ = 0;
			gint _tmp8_ = 0;
			gint _tmp9_ = 0;
			GMenuTreeDirectory* directory = NULL;
			GeeArrayList* _tmp10_ = NULL;
			gint _tmp11_ = 0;
			gpointer _tmp12_ = NULL;
			GMenuTreeDirectory* _tmp13_ = NULL;
			const gchar* _tmp14_ = NULL;
			gchar* _tmp15_ = NULL;
			gchar* _tmp16_ = NULL;
			GeeArrayList* this_category_apps = NULL;
			GMenuTreeDirectory* _tmp17_ = NULL;
			GeeArrayList* _tmp18_ = NULL;
			_tmp7_ = _directory_index;
			_directory_index = _tmp7_ + 1;
			_tmp8_ = _directory_index;
			_tmp9_ = _directory_size;
			if (!(_tmp8_ < _tmp9_)) {
				break;
			}
			_tmp10_ = _directory_list;
			_tmp11_ = _directory_index;
			_tmp12_ = gee_abstract_list_get ((GeeAbstractList*) _tmp10_, _tmp11_);
			directory = (GMenuTreeDirectory*) _tmp12_;
			_tmp13_ = directory;
			_tmp14_ = gmenu_tree_directory_get_name (_tmp13_);
			_tmp15_ = g_strconcat ("Category: ", _tmp14_, NULL);
			_tmp16_ = _tmp15_;
			slingshot_backend_gmenu_entries_log (_tmp16_);
			_g_free0 (_tmp16_);
			_tmp17_ = directory;
			_tmp18_ = slingshot_backend_gmenu_entries_get_applications_for_category (_tmp17_);
			this_category_apps = _tmp18_;
			{
				GeeArrayList* _this_app_list = NULL;
				GeeArrayList* _tmp19_ = NULL;
				GeeArrayList* _tmp20_ = NULL;
				gint _this_app_size = 0;
				GeeArrayList* _tmp21_ = NULL;
				gint _tmp22_ = 0;
				gint _tmp23_ = 0;
				gint _this_app_index = 0;
				_tmp19_ = this_category_apps;
				_tmp20_ = _g_object_ref0 (_tmp19_);
				_this_app_list = _tmp20_;
				_tmp21_ = _this_app_list;
				_tmp22_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp21_);
				_tmp23_ = _tmp22_;
				_this_app_size = _tmp23_;
				_this_app_index = -1;
				while (TRUE) {
					gint _tmp24_ = 0;
					gint _tmp25_ = 0;
					gint _tmp26_ = 0;
					GMenuTreeEntry* this_app = NULL;
					GeeArrayList* _tmp27_ = NULL;
					gint _tmp28_ = 0;
					gpointer _tmp29_ = NULL;
					GeeArrayList* _tmp30_ = NULL;
					GMenuTreeEntry* _tmp31_ = NULL;
					_tmp24_ = _this_app_index;
					_this_app_index = _tmp24_ + 1;
					_tmp25_ = _this_app_index;
					_tmp26_ = _this_app_size;
					if (!(_tmp25_ < _tmp26_)) {
						break;
					}
					_tmp27_ = _this_app_list;
					_tmp28_ = _this_app_index;
					_tmp29_ = gee_abstract_list_get ((GeeAbstractList*) _tmp27_, _tmp28_);
					this_app = (GMenuTreeEntry*) _tmp29_;
					_tmp30_ = the_apps;
					_tmp31_ = this_app;
					gee_abstract_collection_add ((GeeAbstractCollection*) _tmp30_, _tmp31_);
					_gmenu_tree_item_unref0 (this_app);
				}
				_g_object_unref0 (_this_app_list);
			}
			_g_object_unref0 (this_category_apps);
			_gmenu_tree_item_unref0 (directory);
		}
		_g_object_unref0 (_directory_list);
	}
	result = the_apps;
	_g_object_unref0 (all_categories);
	return result;
}


static const gchar* string_to_string (const gchar* self) {
	const gchar* result = NULL;
	g_return_val_if_fail (self != NULL, NULL);
	result = self;
	return result;
}


void slingshot_backend_gmenu_entries_enumerate_apps (GeeArrayList* source, GeeHashMap* icons, gint icon_size, GeeArrayList** list) {
	GeeArrayList* _vala_list = NULL;
	GtkIconTheme* icon_theme = NULL;
	GtkIconTheme* _tmp0_ = NULL;
	GtkIconTheme* _tmp1_ = NULL;
	GeeArrayList* _tmp2_ = NULL;
	GError * _inner_error_ = NULL;
	g_return_if_fail (source != NULL);
	g_return_if_fail (icons != NULL);
	_tmp0_ = gtk_icon_theme_get_default ();
	_tmp1_ = _g_object_ref0 (_tmp0_);
	icon_theme = _tmp1_;
	_tmp2_ = gee_array_list_new (GEE_TYPE_HASH_MAP, (GBoxedCopyFunc) g_object_ref, g_object_unref, NULL);
	_g_object_unref0 (_vala_list);
	_vala_list = _tmp2_;
	{
		GeeArrayList* _app_list = NULL;
		GeeArrayList* _tmp3_ = NULL;
		GeeArrayList* _tmp4_ = NULL;
		gint _app_size = 0;
		GeeArrayList* _tmp5_ = NULL;
		gint _tmp6_ = 0;
		gint _tmp7_ = 0;
		gint _app_index = 0;
		_tmp3_ = source;
		_tmp4_ = _g_object_ref0 (_tmp3_);
		_app_list = _tmp4_;
		_tmp5_ = _app_list;
		_tmp6_ = gee_abstract_collection_get_size ((GeeCollection*) _tmp5_);
		_tmp7_ = _tmp6_;
		_app_size = _tmp7_;
		_app_index = -1;
		while (TRUE) {
			gint _tmp8_ = 0;
			gint _tmp9_ = 0;
			gint _tmp10_ = 0;
			GMenuTreeEntry* app = NULL;
			GeeArrayList* _tmp11_ = NULL;
			gint _tmp12_ = 0;
			gpointer _tmp13_ = NULL;
			gboolean _tmp14_ = FALSE;
			gboolean _tmp15_ = FALSE;
			GMenuTreeEntry* _tmp16_ = NULL;
			gboolean _tmp17_ = FALSE;
			_tmp8_ = _app_index;
			_app_index = _tmp8_ + 1;
			_tmp9_ = _app_index;
			_tmp10_ = _app_size;
			if (!(_tmp9_ < _tmp10_)) {
				break;
			}
			_tmp11_ = _app_list;
			_tmp12_ = _app_index;
			_tmp13_ = gee_abstract_list_get ((GeeAbstractList*) _tmp11_, _tmp12_);
			app = (GMenuTreeEntry*) _tmp13_;
			_tmp16_ = app;
			_tmp17_ = gmenu_tree_entry_get_is_nodisplay (_tmp16_);
			if (_tmp17_ == FALSE) {
				GMenuTreeEntry* _tmp18_ = NULL;
				gboolean _tmp19_ = FALSE;
				_tmp18_ = app;
				_tmp19_ = gmenu_tree_entry_get_is_excluded (_tmp18_);
				_tmp15_ = _tmp19_ == FALSE;
			} else {
				_tmp15_ = FALSE;
			}
			if (_tmp15_) {
				GMenuTreeEntry* _tmp20_ = NULL;
				const gchar* _tmp21_ = NULL;
				_tmp20_ = app;
				_tmp21_ = gmenu_tree_entry_get_icon (_tmp20_);
				_tmp14_ = _tmp21_ != NULL;
			} else {
				_tmp14_ = FALSE;
			}
			if (_tmp14_) {
				GeeHashMap* app_to_add = NULL;
				GeeHashMap* _tmp22_ = NULL;
				GeeHashMap* _tmp23_ = NULL;
				GMenuTreeEntry* _tmp24_ = NULL;
				const gchar* _tmp25_ = NULL;
				GeeHashMap* _tmp26_ = NULL;
				GMenuTreeEntry* _tmp27_ = NULL;
				const gchar* _tmp28_ = NULL;
				GeeHashMap* _tmp29_ = NULL;
				GMenuTreeEntry* _tmp30_ = NULL;
				const gchar* _tmp31_ = NULL;
				GeeHashMap* _tmp32_ = NULL;
				GMenuTreeEntry* _tmp33_ = NULL;
				const gchar* _tmp34_ = NULL;
				GeeHashMap* _tmp35_ = NULL;
				GeeHashMap* _tmp36_ = NULL;
				gpointer _tmp37_ = NULL;
				gchar* _tmp38_ = NULL;
				gboolean _tmp39_ = FALSE;
				gboolean _tmp40_ = FALSE;
				GeeArrayList* _tmp119_ = NULL;
				GeeHashMap* _tmp120_ = NULL;
				_tmp22_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, g_free, NULL, NULL, NULL);
				app_to_add = _tmp22_;
				_tmp23_ = app_to_add;
				_tmp24_ = app;
				_tmp25_ = gmenu_tree_entry_get_comment (_tmp24_);
				gee_abstract_map_set ((GeeAbstractMap*) _tmp23_, "description", _tmp25_);
				_tmp26_ = app_to_add;
				_tmp27_ = app;
				_tmp28_ = gmenu_tree_entry_get_name (_tmp27_);
				gee_abstract_map_set ((GeeAbstractMap*) _tmp26_, "name", _tmp28_);
				_tmp29_ = app_to_add;
				_tmp30_ = app;
				_tmp31_ = gmenu_tree_entry_get_exec (_tmp30_);
				gee_abstract_map_set ((GeeAbstractMap*) _tmp29_, "command", _tmp31_);
				_tmp32_ = app_to_add;
				_tmp33_ = app;
				_tmp34_ = gmenu_tree_entry_get_desktop_file_path (_tmp33_);
				gee_abstract_map_set ((GeeAbstractMap*) _tmp32_, "desktop_file", _tmp34_);
				_tmp35_ = icons;
				_tmp36_ = app_to_add;
				_tmp37_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp36_, "command");
				_tmp38_ = (gchar*) _tmp37_;
				_tmp39_ = gee_abstract_map_has_key ((GeeAbstractMap*) _tmp35_, _tmp38_);
				_tmp40_ = !_tmp39_;
				_g_free0 (_tmp38_);
				if (_tmp40_) {
					gchar* app_icon = NULL;
					GMenuTreeEntry* _tmp41_ = NULL;
					const gchar* _tmp42_ = NULL;
					gchar* _tmp43_ = NULL;
					GMenuTreeEntry* _tmp44_ = NULL;
					const gchar* _tmp45_ = NULL;
					gchar* _tmp46_ = NULL;
					gchar* _tmp47_ = NULL;
					const gchar* _tmp48_ = NULL;
					const gchar* _tmp49_ = NULL;
					gchar* _tmp50_ = NULL;
					gchar* _tmp51_ = NULL;
					GtkIconTheme* _tmp52_ = NULL;
					const gchar* _tmp53_ = NULL;
					gboolean _tmp54_ = FALSE;
					_tmp41_ = app;
					_tmp42_ = gmenu_tree_entry_get_icon (_tmp41_);
					_tmp43_ = g_strdup (_tmp42_);
					app_icon = _tmp43_;
					_tmp44_ = app;
					_tmp45_ = gmenu_tree_entry_get_name (_tmp44_);
					_tmp46_ = g_strconcat (_tmp45_, " Icon :", NULL);
					_tmp47_ = _tmp46_;
					_tmp48_ = app_icon;
					_tmp49_ = string_to_string (_tmp48_);
					_tmp50_ = g_strconcat (_tmp47_, _tmp49_, NULL);
					_tmp51_ = _tmp50_;
					slingshot_backend_gmenu_entries_log (_tmp51_);
					_g_free0 (_tmp51_);
					_g_free0 (_tmp47_);
					_tmp52_ = icon_theme;
					_tmp53_ = app_icon;
					_tmp54_ = gtk_icon_theme_has_icon (_tmp52_, _tmp53_);
					if (_tmp54_) {
						{
							GdkPixbuf* _tmp55_ = NULL;
							GtkIconTheme* _tmp56_ = NULL;
							const gchar* _tmp57_ = NULL;
							gint _tmp58_ = 0;
							GtkIconInfo* _tmp59_ = NULL;
							GtkIconInfo* _tmp60_ = NULL;
							GdkPixbuf* _tmp61_ = NULL;
							GdkPixbuf* _tmp62_ = NULL;
							GeeHashMap* _tmp63_ = NULL;
							GeeHashMap* _tmp64_ = NULL;
							gpointer _tmp65_ = NULL;
							gchar* _tmp66_ = NULL;
							_tmp56_ = icon_theme;
							_tmp57_ = app_icon;
							_tmp58_ = icon_size;
							_tmp59_ = gtk_icon_theme_lookup_icon (_tmp56_, _tmp57_, _tmp58_, 0);
							_tmp60_ = _tmp59_;
							_tmp61_ = gtk_icon_info_load_icon (_tmp60_, &_inner_error_);
							_tmp62_ = _tmp61_;
							_gtk_icon_info_free0 (_tmp60_);
							_tmp55_ = _tmp62_;
							if (G_UNLIKELY (_inner_error_ != NULL)) {
								goto __catch1_g_error;
							}
							_tmp63_ = icons;
							_tmp64_ = app_to_add;
							_tmp65_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp64_, "command");
							_tmp66_ = (gchar*) _tmp65_;
							gee_abstract_map_set ((GeeAbstractMap*) _tmp63_, _tmp66_, _tmp55_);
							_g_free0 (_tmp66_);
							_g_object_unref0 (_tmp55_);
						}
						goto __finally1;
						__catch1_g_error:
						{
							GdkPixbuf* _tmp67_ = NULL;
							GtkIconTheme* _tmp68_ = NULL;
							gint _tmp69_ = 0;
							GtkIconInfo* _tmp70_ = NULL;
							GtkIconInfo* _tmp71_ = NULL;
							GdkPixbuf* _tmp72_ = NULL;
							GdkPixbuf* _tmp73_ = NULL;
							GeeHashMap* _tmp74_ = NULL;
							GeeHashMap* _tmp75_ = NULL;
							gpointer _tmp76_ = NULL;
							gchar* _tmp77_ = NULL;
							const gchar* _tmp78_ = NULL;
							const gchar* _tmp79_ = NULL;
							gchar* _tmp80_ = NULL;
							gchar* _tmp81_ = NULL;
							g_clear_error (&_inner_error_);
							_inner_error_ = NULL;
							_tmp68_ = icon_theme;
							_tmp69_ = icon_size;
							_tmp70_ = gtk_icon_theme_lookup_icon (_tmp68_, "application-default-icon", _tmp69_, 0);
							_tmp71_ = _tmp70_;
							_tmp72_ = gtk_icon_info_load_icon (_tmp71_, &_inner_error_);
							_tmp73_ = _tmp72_;
							_gtk_icon_info_free0 (_tmp71_);
							_tmp67_ = _tmp73_;
							if (G_UNLIKELY (_inner_error_ != NULL)) {
								goto __finally1;
							}
							_tmp74_ = icons;
							_tmp75_ = app_to_add;
							_tmp76_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp75_, "command");
							_tmp77_ = (gchar*) _tmp76_;
							gee_abstract_map_set ((GeeAbstractMap*) _tmp74_, _tmp77_, _tmp67_);
							_g_free0 (_tmp77_);
							_tmp78_ = app_icon;
							_tmp79_ = string_to_string (_tmp78_);
							_tmp80_ = g_strconcat ("Load icon from theme failed: ", _tmp79_, NULL);
							_tmp81_ = _tmp80_;
							slingshot_backend_gmenu_entries_log (_tmp81_);
							_g_free0 (_tmp81_);
							_g_object_unref0 (_tmp67_);
						}
						__finally1:
						if (G_UNLIKELY (_inner_error_ != NULL)) {
							_g_free0 (app_icon);
							_g_object_unref0 (app_to_add);
							_gmenu_tree_item_unref0 (app);
							_g_object_unref0 (_app_list);
							_g_object_unref0 (icon_theme);
							g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
							g_clear_error (&_inner_error_);
							return;
						}
					} else {
						const gchar* _tmp82_ = NULL;
						GFile* _tmp83_ = NULL;
						GFile* _tmp84_ = NULL;
						gboolean _tmp85_ = FALSE;
						gboolean _tmp86_ = FALSE;
						_tmp82_ = app_icon;
						_tmp83_ = g_file_new_for_path (_tmp82_);
						_tmp84_ = _tmp83_;
						_tmp85_ = g_file_query_exists (_tmp84_, NULL);
						_tmp86_ = _tmp85_;
						_g_object_unref0 (_tmp84_);
						if (_tmp86_) {
							{
								GdkPixbuf* _tmp87_ = NULL;
								const gchar* _tmp88_ = NULL;
								const gchar* _tmp89_ = NULL;
								gint _tmp90_ = 0;
								GdkPixbuf* _tmp91_ = NULL;
								GeeHashMap* _tmp92_ = NULL;
								GeeHashMap* _tmp93_ = NULL;
								gpointer _tmp94_ = NULL;
								gchar* _tmp95_ = NULL;
								_tmp88_ = app_icon;
								_tmp89_ = string_to_string (_tmp88_);
								_tmp90_ = icon_size;
								_tmp91_ = gdk_pixbuf_new_from_file_at_scale (_tmp89_, -1, _tmp90_, TRUE, &_inner_error_);
								_tmp87_ = _tmp91_;
								if (G_UNLIKELY (_inner_error_ != NULL)) {
									goto __catch2_g_error;
								}
								_tmp92_ = icons;
								_tmp93_ = app_to_add;
								_tmp94_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp93_, "command");
								_tmp95_ = (gchar*) _tmp94_;
								gee_abstract_map_set ((GeeAbstractMap*) _tmp92_, _tmp95_, _tmp87_);
								_g_free0 (_tmp95_);
								_g_object_unref0 (_tmp87_);
							}
							goto __finally2;
							__catch2_g_error:
							{
								GdkPixbuf* _tmp96_ = NULL;
								GtkIconTheme* _tmp97_ = NULL;
								gint _tmp98_ = 0;
								GtkIconInfo* _tmp99_ = NULL;
								GtkIconInfo* _tmp100_ = NULL;
								GdkPixbuf* _tmp101_ = NULL;
								GdkPixbuf* _tmp102_ = NULL;
								GeeHashMap* _tmp103_ = NULL;
								GeeHashMap* _tmp104_ = NULL;
								gpointer _tmp105_ = NULL;
								gchar* _tmp106_ = NULL;
								FILE* _tmp107_ = NULL;
								g_clear_error (&_inner_error_);
								_inner_error_ = NULL;
								_tmp97_ = icon_theme;
								_tmp98_ = icon_size;
								_tmp99_ = gtk_icon_theme_lookup_icon (_tmp97_, "application-default-icon", _tmp98_, 0);
								_tmp100_ = _tmp99_;
								_tmp101_ = gtk_icon_info_load_icon (_tmp100_, &_inner_error_);
								_tmp102_ = _tmp101_;
								_gtk_icon_info_free0 (_tmp100_);
								_tmp96_ = _tmp102_;
								if (G_UNLIKELY (_inner_error_ != NULL)) {
									goto __finally2;
								}
								_tmp103_ = icons;
								_tmp104_ = app_to_add;
								_tmp105_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp104_, "command");
								_tmp106_ = (gchar*) _tmp105_;
								gee_abstract_map_set ((GeeAbstractMap*) _tmp103_, _tmp106_, _tmp96_);
								_g_free0 (_tmp106_);
								_tmp107_ = stdout;
								fprintf (_tmp107_, "Failed to load icon from file.\n");
								_g_object_unref0 (_tmp96_);
							}
							__finally2:
							if (G_UNLIKELY (_inner_error_ != NULL)) {
								_g_free0 (app_icon);
								_g_object_unref0 (app_to_add);
								_gmenu_tree_item_unref0 (app);
								_g_object_unref0 (_app_list);
								_g_object_unref0 (icon_theme);
								g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
								g_clear_error (&_inner_error_);
								return;
							}
						} else {
							GdkPixbuf* _tmp108_ = NULL;
							GtkIconTheme* _tmp109_ = NULL;
							gint _tmp110_ = 0;
							GtkIconInfo* _tmp111_ = NULL;
							GtkIconInfo* _tmp112_ = NULL;
							GdkPixbuf* _tmp113_ = NULL;
							GdkPixbuf* _tmp114_ = NULL;
							GeeHashMap* _tmp115_ = NULL;
							GeeHashMap* _tmp116_ = NULL;
							gpointer _tmp117_ = NULL;
							gchar* _tmp118_ = NULL;
							_tmp109_ = icon_theme;
							_tmp110_ = icon_size;
							_tmp111_ = gtk_icon_theme_lookup_icon (_tmp109_, "application-default-icon", _tmp110_, 0);
							_tmp112_ = _tmp111_;
							_tmp113_ = gtk_icon_info_load_icon (_tmp112_, &_inner_error_);
							_tmp114_ = _tmp113_;
							_gtk_icon_info_free0 (_tmp112_);
							_tmp108_ = _tmp114_;
							if (G_UNLIKELY (_inner_error_ != NULL)) {
								_g_free0 (app_icon);
								_g_object_unref0 (app_to_add);
								_gmenu_tree_item_unref0 (app);
								_g_object_unref0 (_app_list);
								_g_object_unref0 (icon_theme);
								g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error_->message, g_quark_to_string (_inner_error_->domain), _inner_error_->code);
								g_clear_error (&_inner_error_);
								return;
							}
							_tmp115_ = icons;
							_tmp116_ = app_to_add;
							_tmp117_ = gee_abstract_map_get ((GeeAbstractMap*) _tmp116_, "command");
							_tmp118_ = (gchar*) _tmp117_;
							gee_abstract_map_set ((GeeAbstractMap*) _tmp115_, _tmp118_, _tmp108_);
							_g_free0 (_tmp118_);
							_g_object_unref0 (_tmp108_);
						}
					}
					_g_free0 (app_icon);
				}
				_tmp119_ = _vala_list;
				_tmp120_ = app_to_add;
				gee_abstract_collection_add ((GeeAbstractCollection*) _tmp119_, _tmp120_);
				_g_object_unref0 (app_to_add);
			}
			_gmenu_tree_item_unref0 (app);
		}
		_g_object_unref0 (_app_list);
	}
	_g_object_unref0 (icon_theme);
	if (list) {
		*list = _vala_list;
	} else {
		_g_object_unref0 (_vala_list);
	}
}


SlingshotBackendGMenuEntries* slingshot_backend_gmenu_entries_construct (GType object_type) {
	SlingshotBackendGMenuEntries * self = NULL;
	self = (SlingshotBackendGMenuEntries*) g_object_new (object_type, NULL);
	return self;
}


SlingshotBackendGMenuEntries* slingshot_backend_gmenu_entries_new (void) {
	return slingshot_backend_gmenu_entries_construct (SLINGSHOT_BACKEND_TYPE_GMENU_ENTRIES);
}


static void slingshot_backend_gmenu_entries_class_init (SlingshotBackendGMenuEntriesClass * klass) {
	slingshot_backend_gmenu_entries_parent_class = g_type_class_peek_parent (klass);
}


static void slingshot_backend_gmenu_entries_instance_init (SlingshotBackendGMenuEntries * self) {
}


GType slingshot_backend_gmenu_entries_get_type (void) {
	static volatile gsize slingshot_backend_gmenu_entries_type_id__volatile = 0;
	if (g_once_init_enter (&slingshot_backend_gmenu_entries_type_id__volatile)) {
		static const GTypeInfo g_define_type_info = { sizeof (SlingshotBackendGMenuEntriesClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) slingshot_backend_gmenu_entries_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (SlingshotBackendGMenuEntries), 0, (GInstanceInitFunc) slingshot_backend_gmenu_entries_instance_init, NULL };
		GType slingshot_backend_gmenu_entries_type_id;
		slingshot_backend_gmenu_entries_type_id = g_type_register_static (G_TYPE_OBJECT, "SlingshotBackendGMenuEntries", &g_define_type_info, 0);
		g_once_init_leave (&slingshot_backend_gmenu_entries_type_id__volatile, slingshot_backend_gmenu_entries_type_id);
	}
	return slingshot_backend_gmenu_entries_type_id__volatile;
}



